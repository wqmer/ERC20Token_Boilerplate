
<!DOCTYPE html>

<html>


<head>
    <style>
        ol {
            display: block;
            list-style-type: decimal;
            margin-top: 1em;
            margin-bottom: 1em;
            margin-left: 0;
            margin-right: 0;
            padding-left: 0;
        }
        </style>

  <meta charset="utf-8">


  <script type="text/javascript" src="./lib/jquery-3.3.1.min.js"></script>
  <script type="text/javascript" src="./lib/web3.min0_2.js"></script>
  <script type="text/javascript" src="./lib/FileSaver.min.js"></script>
  <script type="text/javascript" src="./lib/bip39.min.js"></script>
  <script type="text/javascript" src="./lib/ethereumjs-all-2018-1-17.js"></script>
  <script type="text/javascript" src="./lib/hdkey.min.js"></script>
  <script type="text/javascript" src="./lib/keythereum.min.js"></script>
  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script> -->

  <script type="text/javascript" language="javascript" >


var abi = [
    {
      "constant": true,
      "inputs": [],
      "name": "name",
      "outputs": [
        {
          "name": "",
          "type": "string"
        }
      ],
      "payable": false,
      "stateMutability": "view",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [],
      "name": "totalSupply",
      "outputs": [
        {
          "name": "",
          "type": "uint256"
        }
      ],
      "payable": false,
      "stateMutability": "view",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [],
      "name": "decimals",
      "outputs": [
        {
          "name": "",
          "type": "uint8"
        }
      ],
      "payable": false,
      "stateMutability": "view",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "",
          "type": "address"
        }
      ],
      "name": "balanceOf",
      "outputs": [
        {
          "name": "",
          "type": "uint256"
        }
      ],
      "payable": false,
      "stateMutability": "view",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [],
      "name": "symbol",
      "outputs": [
        {
          "name": "",
          "type": "string"
        }
      ],
      "payable": false,
      "stateMutability": "view",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "",
          "type": "address"
        },
        {
          "name": "",
          "type": "address"
        }
      ],
      "name": "allowance",
      "outputs": [
        {
          "name": "",
          "type": "uint256"
        }
      ],
      "payable": false,
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "name": "initialSupply",
          "type": "uint256"
        },
        {
          "name": "tokenName",
          "type": "string"
        },
        {
          "name": "decimalUnits",
          "type": "uint8"
        },
        {
          "name": "tokenSymbol",
          "type": "string"
        }
      ],
      "payable": false,
      "stateMutability": "nonpayable",
      "type": "constructor"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "name": "from",
          "type": "address"
        },
        {
          "indexed": true,
          "name": "to",
          "type": "address"
        },
        {
          "indexed": false,
          "name": "value",
          "type": "uint256"
        }
      ],
      "name": "Transfer",
      "type": "event"
    },
    {
      "constant": false,
      "inputs": [
        {
          "name": "_to",
          "type": "address"
        },
        {
          "name": "_value",
          "type": "uint256"
        }
      ],
      "name": "transfer",
      "outputs": [],
      "payable": false,
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "constant": false,
      "inputs": [
        {
          "name": "addr",
          "type": "address"
        }
      ],
      "name": "getBalance",
      "outputs": [
        {
          "name": "",
          "type": "uint256"
        }
      ],
      "payable": false,
      "stateMutability": "nonpayable",
      "type": "function"
    }
  ] ;




// var contractaddress = "0x0fe98c62c1f47687877335ce7879ac78bce262bd" ;

// var DemoToken = web3.eth.contract(abi).at(contractaddress);
// var accountOne = "0x66eFf2F73d7E53F5D38Ca1249983af0E13B330fc";
//var accountTwo = web3.eth.accounts[1];
 
// var secretSeed = lightwallet.keystore.generateRandomSeed();
// var address = keystore.generateNewAddress(pwDerivedKey, [num]);
// var seed_one = "spot plunge retire helmet skin notice furnace obtain hour cousin oxygen post";
// var mnemonic = seed_one ;
// var hdwallet = hdkey.fromMasterSeed(bip39.mnemonicToSeed(mnemonic));
// var wallet_hdpath = "m/44'/60'/0'/0/";
// var wallets = {};
// var addresses = [];
// var num_addresses = 5 ;
// var address_index = 0 ;
// console.log(hdwallet.derive(wallet_hdpath));


// generate new addres by mnemonic
    //  for (let i = address_index ; i < address_index  + num_addresses ; i++){
    //   var wallet = hdwallet.derive(wallet_hdpath + i).getWallet();
    //   var addr = '0x' + wallet.getAddress().toString('hex');
    //   addresses.push(addr);
    //   wallets[addr] = wallet;
    // }

var Web3 = require('web3');
var web3 = new Web3();
//web3.setProvider(new web3.providers.HttpProvider('https://mainnet.infura.io/1BPk9syIaAtEQzRuW9uF'));
web3.setProvider(new web3.providers.HttpProvider('https://ropsten.infura.io/1BPk9syIaAtEQzRuW9uF'));


// var blob = new Blob(["欢迎访问 hangge.com"], {type: "text/plain;charset=utf-8"});
// saveAs(blob, "文件.txt");
// var ks = new lightwallet.keystore(secretSeed, pwDerivedKey);
// // generate five new address/private key pairs
// // the corresponding private keys are also encrypted
// ks.generateNewAddress(pwDerivedKey, 5);

//check token balance 
//var accountOneBalance = DemoToken.getBalance.call(accountOne);
//console.log(accountOneBalance.toNumber());

// //check eth balance
// var EthBalance = web3.fromWei(web3.eth.getBalance(accountOne),'ether');
// console.log(EthBalance.toNumber());

//send token  
//check txhash

//  var txhashToken = DemoToken.transfer.sendTransaction(accountTwo, 150000, {from:accountOne});
//  console.log(txhashToken);

//send eth (withdraw)
// //check txhash
// var txhashEth = web3.eth.sendTransaction({from: accountOne, to:accountTwo, value: web3.toWei(1, 'ether'), gasLimit: 70000, gasPrice: 20000000000});
// console.log(txhashEth);

//receipt 
// var receipt = web3.eth.getTransactionReceipt(txhashEth);
// console.log(receipt) ;



//  function watchBalance() {
//         var coinbase = web3.eth.coinbase;
//         var originalBalance = web3.eth.getBalance(coinbase).toNumber();
//         document.getElementById('coinbase').innerText = coinbase;
//         document.getElementById('original').innerText = ' original balance: ' + originalBalance ;
//         web3.eth.filter('latest').watch(function() {
//             var currentBalance = web3.eth.getBalance(coinbase).toNumber();
//             //document.getElementById("current").innerText = 'current: ' + currentBalance;
//             //document.getElementById("diff").innerText = 'diff:    ' + (currentBalance - originalBalance);
//         });
//     }



// function copyToClipboard(element) {
//          var $temp = $("<input>");
//          $("body").append($temp);
//          $temp.val($(element).html()).select(); //Note the use of html() rather than text()
//          document.execCommand("copy");
//          $temp.remove(); 

         

        //   var outfile, outpath, json;
        //   var pathname= "./";
        //   var outpath = "./";
        //   outfile = keythereum.generateKeystoreFilename(keyObject.address);
        //  // outpath = path.join(pathname, outfile);
        //   json = JSON.stringify(keyObject);
        //   fs.writeFile(outpath, json) ;     



  
//   id: "e13b209c-3b2f-4327-bab0-3bef2e51630d",
//   version: 3
// }
// keythereum.exportToFile(keyObject);
//hook with contract 
//bug free , password viladate  ,balance viladate , address format viladate.
//error processing 
//copy to clipboard 
//restore a wallet wtih seed .Create a wallet with seed.



// <!-- 
// var gaslimit = 21000 ;//deafult
// //var privateKey = '350d47e3dfc4e10db99a919d0e066d9f5b6f7e598f7d46a1b8aed3ab987737a2';
// var privateKey = new Buffer('350d47e3dfc4e10db99a919d0e066d9f5b6f7e598f7d46a1b8aed3ab987737a2', 'hex');
// var nonce = web3.eth.getTransactionCount('0x680A48f49015dC5221E6b0bfdE6B9c2154db928E');

// var value = 500000000000000 ;
// var rawTx = {
//     nonce: nonce,
//     gasPrice: '0x09184e72a000', 
//     gasLimit: gaslimit,
//     to: '0x66eFf2F73d7E53F5D38Ca1249983af0E13B330fc', 
//     value: value 
//   //data: '0x7f7465737432000000000000000000000000000000000000000000000000000000600057'
// }
// var tx = new ethereumjs.Tx(rawTx);
// tx.sign(privateKey);
// var serializedTx = tx.serialize();
// var hashtx = web3.eth.sendRawTransaction('0x' + serializedTx.toString('hex'));
// console.log(hashtx); 
// <!-- 
// var result = web3.eth.estimateGas({
//     to: "0xc4abd0339eb8d57087278718986382264244252f", 
//     data: "0xc6888fa10000000000000000000000000000000000000000000000000000000000000003"
// });

// var hexamount = web3.toHex(0.12) ;
// console.log(hexamount); -->
//var al= jQuery('#hashlist a');

   
    
    //link.herf = "http://the.new.url" ;
    //var link = jQuery('#link')




</script>

</head>

<body>
    
  

    <h1>ETHEREUM WALLET</h1>
    <br>
  
    <h2>Wallet</h2> 
     Restore your wallet:
     <br>
      
    <input type="file" id="importkey" name="upload your key" /> 
    &nbsp &nbsp &nbsp &nbsp &nbsp 
    <button id = "unlock" >Restore a wallet </button>
    <br>
    <br>
     Create a new wallet: &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp
     &nbsp  <button id = "newWallet" >Create a wallet </button>
    <!-- <br> add new address : &nbsp &nbsp &nbsp &nbsp <button id = "new address" >Add address </button>   -->
    <br>
    <br>
    <br>
    You address here:
    <br>
    <div id="addresslist"  >
      <span></span> 
    </div>

    <br> 
    Balance :
    <div id="balancelist"  >
      <span></span> 
    </div>
       

    
    <!-- generate a new address and pop-up the private key  -->
    

    <!-- input a address and onClick to check balance  -->
  
    
    <!-- <div>  


      <div id="showEthbalance"> </div> 

      <div id="showTokenbalance"> </div> 
    
    </div>  -->
   
   

     <!-- input a new address , amount ,and type of coin . OnClick to send .-->
    <h2>Send Eth</h2>

    <div>  

         &nbsp Amount&nbsp &nbsp  &nbsp &nbsp &nbsp &nbsp &nbsp  Input destination address here <br> 
         <input id="amount" type="text"  size="10">  
         <input id="destination" type="text" size="50" >  <br><br> 
         <button id="withdraw" >withdraw</button> 
     
    </div> 

    <br>
   
     
    <h2>Transaction hash </h2>

     <div id ="hashlist"  style="text-align:left"  >
     <ol  id = "ol"  ></ol> 
     <!-- <ol  id = "testol" ></ol>  -->
     <!-- <a id ="link" ></a> -->
     </div> 

 
   
    
  

 

     
    

    <script src="./lib/jquery-3.3.1.min.js"></script>
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script> -->
    <script src="./wallet.js"></script>


  


</body>

</html>